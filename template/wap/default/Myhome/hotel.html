<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN""http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<title>酒店详情</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta name="format-detection" content="telephone=no">
<script type="text/javascript" src="__STATIC__/js/jquery-1.8.1.min.js"></script>
<script type="text/javascript" src="__STATIC__/js/icheck.js"></script>
<script type="text/javascript" src="__STATIC__/js/swipeslider.min.js"></script>
<script src="__PUBLIC__/static/layui/layui.all.js"></script>
<link rel="stylesheet" href="__STATIC__/css/hotel.css" />
<style>
  .hotel_relax ul li span{
    display: block;
      height: 40px;
      width: 100%;
      background-image: url(__STATIC__/images/hotelimg/sjxq_03.png);
      margin-top: 5px;
  }
  .icheckbox_square-orange,
  .iradio_square-orange {
      display: inline-block;
      *display: inline;
      vertical-align: middle;
      margin: 0;
      padding: 0;
      width: 22px;
      height: 22px;
      background: url(__STATIC__/images/hotelimg/orange.png) no-repeat;
      border: none;
      cursor: pointer;
  }
  @media (-o-min-device-pixel-ratio: 5/4), (-webkit-min-device-pixel-ratio: 1.25), (min-resolution: 120dpi) {
    .icheckbox_square-orange,
    .iradio_square-orange {
        background-image: url(__STATIC__/images/hotelimg/orange@2x.png);
        -webkit-background-size: 240px 24px;
        background-size: 240px 24px;
    }
}
</style>
</head>
<body>
<!--轮播图-->
  <div class="container1">       
    <div id="full_feature" class="swipslider">
      <ul class="sw-slides">
      {volist name="img_list" id="v"}
       <li class="sw-slide">
          <img src="{$v}" width="100%" height="100%" />
        </li>
        {/volist}
      </ul>
    </div>      
</div>
 <script type="text/javascript">
    $(window).load(function() {
          $('#full_feature').swipeslider();
        });
  </script>
  <div class="comment_1">
    <div class="content-top">
      <span><i>4.8</i>分，棒极了！</span>
      <span>99条评论</span>
    </div>
    <div class="content-bottom">
      <ul>
        <li>性价比高</li>
        <li>卫生干净</li>
        <li>隔音好</li>
      </ul>
    </div>
  </div> 
</div>

<div class="order_big">
  <div class="content-order">
    <div class="map_left">
      <span>{$address}</span>
    </div>
   <!--  <div class="map_right">
      <a href="">附近酒店</a>
    </div> -->
  </div>
  <div class="hotel_relax">
  <ul>
    <li>
      <span id="item1"></span>
      <p>无线上网</p>
    </li>
    <li>
      <span id="item2"></span>
      <p>热水洗浴</p>
    </li>
    <li>
      <span id="item3"></span>
      <p>电吹风</p>
    </li>
    <li>
      <span id="item4"></span>
      <p>洗漱用具</p>
    </li>
  </ul>
 
</div>
  <div class="order_time">
    <div class="time_left">
      <span>入住</span>
      <input type="text" id="startDate"  placeholder="请选择入住时间" />
    </div>
    <div class="time_right">
      <span>离店</span>
      <input type="text" id="endDate"  placeholder="请选择离店时间" />
    </div>
   
  </div>

{volist name="room_list" id="v"}
<div class="order_room">
    <div class="order_singleroom">
      <span>{$v.room_type}</span>
      <!-- <span>不含早|有窗<br/>入住当天十二点前免费取消</span> -->
      <span>{$v.remark}</span>
      <span>￥{$v.room_price}</span>
    </div>
    {if $v.room_status eq 0}
    <div class="order_button">
      <input type="button" value="预定" class="reserve" status="" data-id="{$v.room_id}"/>
      <input type="hidden" class="hidden" value="" />
    </div>
    {else/}
     <div class="order_button_2">
      <div class="special_room">
      <span>当天满房</span>
      <input type="button" value="预订" class="reserve" status="" disabled style="background-color: #cccccc;" />
      </div>
    </div>
    {/if}  
</div>
{/volist}


<div class="fulled">  
  <div class="fix-box">  
    <p class="close">关闭</p><br/>
    <div class="select_num">
        <!-- <input type="radio" name="iCheck" class="radio" value="1">1
        <input type="radio" name="iCheck" class="radio" value="2">2
        <input type="radio" name="iCheck" class="radio" value="3">3 -->
    </div> 
    <div class="qita">数量:<input type="number" value="1"  placeholder="请输入数量"/></div>    
    <div class="confirm">
      <button>确定</button>
    </div>
  </div>  
</div> 
<div class="footer">
      <div class="footer_money">
        <span>已选择&nbsp;<b class="nums" style="color:#cc0045">0</b>&nbsp;间房</span> 
      </div>
      <div class="footer_btn" >
        <input type="button" value="确定订单" disabled style="background-color: #cccccc;border:none;color:#fff;" />
      </div>
  </div> 
</div>

<script>
    var uid = "{$uid}";  //获取会员uid
    var business_id = "{$business_id}";  //获取商家ID
   layui.use('laydate', function(){
        var laydate = layui.laydate;
       laydate.render({ 
          elem: '#startDate'
          //,type: 'date' //默认，可不填
        });
       laydate.render({ 
          elem: '#endDate'
          //,type: 'date' //默认，可不填
        });
    })
   var flag = true; 
  //点击确定订单
   $('.footer_btn>input').click(function(){
      var id_arr = new Array();
      var num_arr = new Array();
      $('.reserve').each(function(i,v){
        if($(v).attr('status') != ''){ 
            id_arr.push($(v).attr('data-id'));  //预定的酒店房间ID数组
            num_arr.push($(v).attr('status'));  //预定的数量数组
        }
      })
      var startDate = $('#startDate').val(); //入住时间
      var endDate = $('#endDate').val(); //离店时间
      var url = "{:url('Myhome/hotel_order')}";
      var data = {
        id_arr:id_arr,
        startDate:startDate,
        endDate:endDate,
        num_arr:num_arr,
        uid:uid,
        business_id:business_id
      };
      $.post(url,data,function(res){
        console.log(res);
          if(res.status == 1){
            layer.msg(res.msg,{time:1200});
            setTimeout(function(){
              window.location.href = "{:__URL('APP_MAIN/Myhome/hotelorderdetail')}?out_trade_no="+res.out_trade_no;
            },1200)
          }else{
            layer.msg(res.msg,{time:1200});
          }
      },'json')
   })
   //点击预定弹出层
   $(document).ready(function() {  
    var room_id;  //获取点击预定的房间类型ID,之后方便做处理
    $(".reserve").on("click", function(event) {
        event.preventDefault();  
        $(".fulled").fadeIn();
        room_id =  $(this).attr('data-id');
    })
    //点击添加数量确定按钮
     $('.confirm>button').click(function(){
          var total_room_num = 0;
          var room_num = $("input[type='number']").val(); //预定数量
          if(room_num != '' && room_num != 0){
              $('.reserve').each(function(i,v){
                if($(v).attr('data-id')==room_id){
                  $(v).val('已预订'+room_num);
                  $(v).attr('status',room_num);
                }
          
                if($(v).attr('status') != ''){
                    total_room_num += ($(v).attr('status')-0);
                }
              })
          }else{
            layer.msg('请输入正确的数量',{time:1200});
            return;
          }
    
          $('.footer_money b').text(Number(total_room_num));
          if($('.footer_money b').text() != 0){
            $('.footer_btn input').css({"background-color":"#fe622f"});
            $('.footer_btn input').attr('disabled',false);
          }else{
            $('.footer_btn input').css({"background-color":"#cccccc"});
            $('.footer_btn input').attr('disabled',true);
          }
          $(".fulled").hide();
      })  
    $(".close").on("click", function(event) {  
        if ($(event.target).is(".close") || $(event.target).is(".fix-box")) {  
            //alert(123)  
            event.preventDefault();  
            $(".fulled").hide();  
        }  
    })  
    $(document).keyup(function(event) {
        if (event.which == "27") {  
            $(".fulled").fadeOut();  
        }  
  
    }) 
     $('input').iCheck({
    checkboxClass: 'icheckbox_square-orange',
    radioClass: 'iradio_square-orange',
    increaseArea: '20%' // optional
  });
})  





// $(function() {
//     // 把要操作的对象先获取到
//     var banner = $('.banner');
//     var Left = $('.left'); // alert(Left.length);
//     var Right = $('.right');
//     var Ul = $('.banner ul'); // alert(Ul.length);
//     var Width = $('.banner ul li').width(); //alert(Width);
//     var Point = $('.banner ol li'); // alert(Point.length);
//     var Index = 0; //用于记录点击的次数，图片的张数(计数器，记录了图片移动的张数)

//     //点击小圆点让图片移动
//     $.each(Point, function(index, value) { //如果此处我没有用each循环来写，那么我便需要用$(this).index()方法来获取图片的下标
//         //让点击的小圆点有class样式，其他li没有class样式
//         Point.eq(index).on('click', function() {
//             $(this).addClass('now').siblings().removeClass('now');
//             Ul.stop().animate({
//                 'left': -index * Width
//             });
//             Index = index;
//             console.log(Index);
//             //alert(Index);
//         })
//     });

//     //  点击右箭头,ul往左跑
//     Right.on('click', function() {
//         //需要做一个判断，如果发现此时图片是最后一张图片，就不能继续执行了
//         //让index是图片的张数减一的时候,让index不继续加
//         if (Index >= 6) {
//             //让index变成0
//             Index = 0;
//             //                让ul的left值瞬间变成0
//             Ul.css('left', 0);
//         }
//         Index++;
//         Ul.stop().animate({
//             'left': -Index * Width
//         });

//         if (Index == 6) {
//             //因为在图片最后面添加了一张假图片，其实最后一张图片的时候，需要对应的是索引0的小圆点
//             Point.eq(0).addClass('now').siblings().removeClass('now');

//         } else {
//             Point.eq(Index).addClass('now').siblings().removeClass('now');
//         }

//     })

//     //点击左箭头,让Ul往右跑
//     Left.on('click', function() {
//         if (Index <= 0) {
//             //return; 此时不应该return,应该让index变成最大的值，left也变成最大的left
//             Index = 6;
//             Ul.css('left', -Index * Width);
//         }
//         Index--;
//         Ul.stop().animate({
//             'left': -Index * Width
//         });

//         if (Index == 6) {
//             //因为在图片最后面添加了一张假图片，其实最后一张图片的时候，需要对应的是索引0的小圆点
//             Point.eq(0).addClass('now').siblings().removeClass('now');
//         } else {
//             Point.eq(Index).addClass('now').siblings().removeClass('now');
//         }

//     })



//     //调取Right方法，使其自动播放
//     var time = setInterval(function() {
//         Right.click();
//     }, 3000);

//     //鼠标移到banner中,自动播放停止
//     banner.mouseenter(function() {
//         clearInterval(time);
//     });

//     // 鼠标移出banner中,自动播放开始
//     banner.mouseleave(function() {
//         time = setInterval(function() {
//             Right.click();
//         }, 3000);
//     })
// })
</script>
</body>
</html>